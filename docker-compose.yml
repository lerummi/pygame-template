services:
  pygbag:
    build:
      context: .
      dockerfile: Dockerfile
    image: pygame-template-pygbag:latest
    ports:
      - "8000:8000"
    volumes:
      - .:/workspace:rw
    stdin_open: true
    tty: true
    command: ["/workspace/watch-and-reload.sh"]
    environment:
      # APP_DIR specifies which directory to build
      # Can be set via: APP_DIR=learn/1_tasten docker compose up
      # Or in a .env file
      # Defaults to "app" if not set
      APP_DIR: "${APP_DIR:-app}"
      BUILD_SCRIPT: "/workspace/build-and-run.sh"
      # Enable detailed Python error logging
      PYTHONUNBUFFERED: "1"
      PYTHONDONTWRITEBYTECODE: "1"
      PYTHONASYNCIODEBUG: "1"
    restart: unless-stopped